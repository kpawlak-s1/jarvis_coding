{
  "formats": [
    {
      "format": "${parse=gron}$"
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "sourcetype matches 'zscalernss-web' && event.protocol matches 'HTTPS'",
        "transformations": [
          {
            "drop": {
              "field": "sourcetype"
            }
          },
          {
            "rename_tree": {
              "from": "event",
              "to": ""
            }
          },
          {
            "copy": {
              "from": "protocol",
              "to": "http_request.url.scheme"
            }
          },
          {
            "copy": {
              "from": "urlcategory",
              "to": "http_request.url.categories"
            }
          },
          {
            "copy": {
              "from": "refererURL",
              "to": "http_request.http_headers"
            }
          },
          {
            "copy": {
              "from": "useragent",
              "to": "http_request.user_agent"
            }
          },
          {
            "copy": {
              "from": "devicehostname",
              "to": "src_endpoint.hostname"
            }
          },
          {
            "copy": {
              "from": "servertranstime",
              "to": "http_response.latency"
            }
          },
          {
            "copy": {
              "from": "datetime",
              "to": "metadata.original_time"
            }
          },
          {
            "copy": {
              "from": "reason",
              "to": "status_detail"
            }
          },
          {
            "copy": {
              "from": "action",
              "to": "unmapped.action"
            }
          },
          {
            "copy": {
              "from": "action",
              "to": "status_id"
            }
          },
          {
            "cast": {
              "type": "enum",
              "field": "status_id",
              "enum": {
                "Allowed": 1,
                "Blocked": 2
              }
            }
          },
          {
            "copy": {
              "from": "transactionsize",
              "to": "network_traffic.bytes"
            }
          },
          {
            "copy": {
              "from": "responsesize",
              "to": "network_traffic.bytes_in"
            }
          },
          {
            "copy": {
              "from": "requestsize",
              "to": "network_traffic.bytes_out"
            }
          },
          {
            "copy": {
              "from": "serverip",
              "to": "dst_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "clienttranstime",
              "to": "unmapped.clienttranstime"
            }
          },
          {
            "copy": {
              "from": "requestmethod",
              "to": "activity_name"
            }
          },
          {
            "copy": {
              "from": "location",
              "to": "src_endpoint.location.desc"
            }
          },
          {
            "copy": {
              "from": "deviceowner",
              "to": "actor.user.name"
            }
          },
          {
            "copy": {
              "from": "clientpublicIP",
              "to": "src_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "threatname",
              "to": "malware.name"
            }
          },
          {
            "copy": {
              "from": "filetype",
              "to": "unmapped.filetype"
            }
          },
          {
            "copy": {
              "from": "appname",
              "to": "app_name"
            }
          },
          {
            "copy": {
              "from": "department",
              "to": "actor.user.organization.ou_name"
            }
          },
          {
            "copy": {
              "from": "urlsupercategory",
              "to": "unmapped.urlsupercategory"
            }
          },
          {
            "copy": {
              "from": "appclass",
              "to": "unmapped.appclass"
            }
          },
          {
            "copy": {
              "from": "dlpengine",
              "to": "unmapped.dlpengine"
            }
          },
          {
            "copy": {
              "from": "urlclass",
              "to": "unmapped.urlclass"
            }
          },
          {
            "copy": {
              "from": "threatclass",
              "to": "malware.classifications"
            }
          },
          {
            "copy": {
              "from": "dlpdictionaries",
              "to": "unmapped.dlpdictionaries"
            }
          },
          {
            "copy": {
              "from": "fileclass",
              "to": "unmapped.fileclass"
            }
          },
          {
            "copy": {
              "from": "bwthrottle",
              "to": "unmapped.bwthrottle"
            }
          },
          {
            "copy": {
              "from": "contenttype",
              "to": "unmapped.contenttype"
            }
          },
          {
            "copy": {
              "from": "unscannabletype",
              "to": "unmapped.unscannabletype"
            }
          },
          {
            "copy": {
              "from": "protocol",
              "to": "event.type"
            }
          },
          {
            "copy": {
              "from": "serverip",
              "to": "observables[0].value"
            }
          },
          {
            "copy": {
              "from": "clientpublicIP",
              "to": "observables[1].value"
            }
          },
          {
            "copy": {
              "from": "deviceowner",
              "to": "observables[2].value"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": "4"
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          },
          {
            "constant": {
              "field": "metadata.product.vendor_name",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.0.0"
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 1
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 400299
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "HTTP Activity: Other"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 4002
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "HTTP Activity"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "dst_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          },
          {
            "constant": {
              "field": "observables[1].name",
              "value": "src_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          },
          {
            "constant": {
              "field": "observables[2].name",
              "value": "deviceowner"
            }
          },
          {
            "constant": {
              "field": "observables[2].type",
              "value": "User Name"
            }
          },
          {
            "constant": {
              "field": "observables[2].type_id",
              "value": 4
            }
          }
        ]
      },
      {
        "predicate": "sourcetype matches 'zscalernss-web' && event.protocol matches 'FTP'",
        "transformations": [
          {
            "drop": {
              "field": "sourcetype"
            }
          },
          {
            "rename_tree": {
              "from": "event",
              "to": ""
            }
          },
          {
            "copy": {
              "from": "protocol",
              "to": "unmapped.protocol"
            }
          },
          {
            "copy": {
              "from": "urlcategory",
              "to": "unmapped.urlcategory"
            }
          },
          {
            "copy": {
              "from": "refererURL",
              "to": "unmapped.refererURL"
            }
          },
          {
            "copy": {
              "from": "useragent",
              "to": "unmapped.useragent"
            }
          },
          {
            "copy": {
              "from": "devicehostname",
              "to": "device.hostname"
            }
          },
          {
            "copy": {
              "from": "servertranstime",
              "to": "unmapped.servertranstime"
            }
          },
          {
            "copy": {
              "from": "datetime",
              "to": "metadata.original_time"
            }
          },
          {
            "copy": {
              "from": "reason",
              "to": "status_detail"
            }
          },
          {
            "copy": {
              "from": "action",
              "to": "unmapped.action"
            }
          },
          {
            "copy": {
              "from": "action",
              "to": "status_id"
            }
          },
          {
            "cast": {
              "type": "enum",
              "field": "status_id",
              "enum": {
                "Allowed": 1,
                "Blocked": 2
              }
            }
          },
          {
            "copy": {
              "from": "transactionsize",
              "to": "network_traffic.bytes"
            }
          },
          {
            "copy": {
              "from": "responsesize",
              "to": "network_traffic.bytes_in"
            }
          },
          {
            "copy": {
              "from": "requestsize",
              "to": "network_traffic.bytes_out"
            }
          },
          {
            "copy": {
              "from": "serverip",
              "to": "dst_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "clienttranstime",
              "to": "unmapped.clienttranstime"
            }
          },
          {
            "copy": {
              "from": "requestmethod",
              "to": "activity_name"
            }
          },
          {
            "copy": {
              "from": "location",
              "to": "src_endpoint.location.desc"
            }
          },
          {
            "copy": {
              "from": "deviceowner",
              "to": "actor.user.name"
            }
          },
          {
            "copy": {
              "from": "clientpublicIP",
              "to": "src_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "threatname",
              "to": "malware.name"
            }
          },
          {
            "copy": {
              "from": "filetype",
              "to": "unmapped.filetype"
            }
          },
          {
            "copy": {
              "from": "appname",
              "to": "app_name"
            }
          },
          {
            "copy": {
              "from": "department",
              "to": "actor.user.organization.ou_name"
            }
          },
          {
            "copy": {
              "from": "urlsupercategory",
              "to": "unmapped.urlsupercategory"
            }
          },
          {
            "copy": {
              "from": "appclass",
              "to": "unmapped.appclass"
            }
          },
          {
            "copy": {
              "from": "dlpengine",
              "to": "unmapped.dlpengine"
            }
          },
          {
            "copy": {
              "from": "urlclass",
              "to": "unmapped.urlclass"
            }
          },
          {
            "copy": {
              "from": "threatclass",
              "to": "malware.classifications"
            }
          },
          {
            "copy": {
              "from": "dlpdictionaries",
              "to": "unmapped.dlpdictionaries"
            }
          },
          {
            "copy": {
              "from": "fileclass",
              "to": "unmapped.fileclass"
            }
          },
          {
            "copy": {
              "from": "bwthrottle",
              "to": "unmapped.bwthrottle"
            }
          },
          {
            "copy": {
              "from": "contenttype",
              "to": "unmapped.contenttype"
            }
          },
          {
            "copy": {
              "from": "unscannabletype",
              "to": "unmapped.unscannabletype"
            }
          },
          {
            "copy": {
              "from": "protocol",
              "to": "event.type"
            }
          },
          {
            "copy": {
              "from": "serverip",
              "to": "observables[0].value"
            }
          },
          {
            "copy": {
              "from": "clientpublicIP",
              "to": "observables[1].value"
            }
          },
          {
            "copy": {
              "from": "deviceowner",
              "to": "observables[2].value"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": "4"
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          },
          {
            "constant": {
              "field": "metadata.product.vendor_name",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.0.0"
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 0
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 400899
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "FTP Activity: Other"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 4008
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "FTP Activity"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "dst_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          },
          {
            "constant": {
              "field": "observables[1].name",
              "value": "src_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          },
          {
            "constant": {
              "field": "observables[2].name",
              "value": "deviceowner"
            }
          },
          {
            "constant": {
              "field": "observables[2].type",
              "value": "User Name"
            }
          },
          {
            "constant": {
              "field": "observables[2].type_id",
              "value": 4
            }
          }
        ]
      },
      {
        "predicate": "sourcetype matches 'zscalernss-audit'",
        "transformations": [
          {
            "rename": {
              "from": "sourcetype",
              "to": "metadata.event_code"
            }
          },
          {
            "rename": {
              "from": "event.time",
              "to": "time_dt"
            }
          },
          {
            "rename": {
              "from": "event.recordid",
              "to": "metadata.uid"
            }
          },
          {
            "copy": {
              "from": "event.action",
              "to": "activity_name"
            }
          },
          {
            "copy": {
              "from": "event.action",
              "to": "activity_id"
            }
          },
          {
            "cast": {
              "type": "enum",
              "field": "activity_id",
              "enum": {
                "CREATE": 1,
                "READ": 2,
                "UPDATE": 3,
                "DELETE": 4,
                "ACTIVATE": 10,
                "DEACTIVATE": 11
              },
              "enum_default": 99
            }
          },
          {
            "copy": {
              "from": "event.action",
              "to": "type_uid"
            }
          },
          {
            "cast": {
              "type": "enum",
              "field": "type_uid",
              "enum": {
                "CREATE": 300401,
                "READ": 300402,
                "UPDATE": 300403,
                "DELETE": 300404,
                "ACTIVATE": 300410,
                "DEACTIVATE": 300411
              },
              "enum_default": 300499
            }
          },
          {
            "copy": {
              "from": "event.action",
              "to": "type_name"
            }
          },
          {
            "cast": {
              "type": "enum",
              "field": "type_name",
              "enum": {
                "CREATE": "Entity Management: Create",
                "READ": "Entity Management: Read",
                "UPDATE": "Entity Management: Update",
                "DELETE": "Entity Management: Delete",
                "ACTIVATE": "Entity Management: Activate",
                "DEACTIVATE": "Entity Management: Deactivate"
              },
              "enum_default": "Entity Management: Other"
            }
          },
          {
            "rename": {
              "from": "event.category",
              "to": "metadata.log_name"
            }
          },
          {
            "rename": {
              "from": "event.subcategory",
              "to": "metadata.labels[0]"
            }
          },
          {
            "rename": {
              "from": "event.resource",
              "to": "metadata.labels[1]"
            }
          },
          {
            "rename": {
              "from": "event.interface",
              "to": "actor.app_name"
            }
          },
          {
            "rename": {
              "from": "event.adminid",
              "to": "actor.user.email_addr"
            }
          },
          {
            "copy": {
              "from": "event.clientip",
              "to": "src_endpoint.ip"
            }
          },
          {
            "rename": {
              "from": "event.result",
              "to": "status"
            }
          },
          {
            "rename": {
              "from": "event.errorcode",
              "to": "status_code"
            }
          },
          {
            "rename": {
              "from": "event.auditlogtype",
              "to": "src_endpoint.name"
            }
          },
          {
            "rename": {
              "from": "event.preaction",
              "to": "entity.data"
            }
          },
          {
            "rename": {
              "from": "event.postaction",
              "to": "entity_result.data"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "Date/Time"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[1]",
              "value": "Host"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": 3
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Identity & Access Management"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 3004
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "Entity Management"
            }
          },
          {
            "constant": {
              "field": "metadata.product.name",
              "value": "ZScaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.5.0"
            }
          },
          {
            "constant": {
              "field": "severity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "event.type",
              "value": "Audit"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "src_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          },
          {
            "rename": {
              "from": "event.clientip",
              "to": "observables[0].value"
            }
          }
        ]
      },
      {
        "predicate": "sourcetype matches 'zscalernss-dns'",
        "transformations": [
          {
            "rename": {
              "from": "sourcetype",
              "to": "metadata.event_code"
            }
          },
          {
            "rename": {
              "from": "event.datetime",
              "to": "time_dt"
            }
          },
          {
            "rename": {
              "from": "event.user",
              "to": "actor.user.email_addr"
            }
          },
          {
            "rename": {
              "from": "event.department",
              "to": "actor.user.org.ou_name"
            }
          },
          {
            "rename": {
              "from": "event.location",
              "to": "src_endpoint.location.city"
            }
          },
          {
            "rename": {
              "from": "event.reqaction",
              "to": "unmapped.event.reqaction"
            }
          },
          {
            "rename": {
              "from": "event.resaction",
              "to": "unmapped.event.resaction"
            }
          },
          {
            "rename": {
              "from": "event.reqrulelabel",
              "to": "unmapped.event.reqrulelabel"
            }
          },
          {
            "rename": {
              "from": "event.resrulelabel",
              "to": "unmapped.event.resrulelabel"
            }
          },
          {
            "rename": {
              "from": "event.dns_reqtype",
              "to": "unmapped.event.dns_reqtype"
            }
          },
          {
            "rename": {
              "from": "event.dns_req",
              "to": "query.hostname"
            }
          },
          {
            "rename": {
              "from": "event.dns_resp",
              "to": "unmapped.event.dns_resp"
            }
          },
          {
            "rename": {
              "from": "event.srv_dport",
              "to": "unmapped.event.srv_dport"
            }
          },
          {
            "rename": {
              "from": "event.durationms",
              "to": "response_time"
            }
          },
          {
            "rename": {
              "from": "event.clt_sip",
              "to": "unmapped.event.clt_sip"
            }
          },
          {
            "rename": {
              "from": "event.srv_dip",
              "to": "unmapped.event.srv_dip"
            }
          },
          {
            "rename": {
              "from": "event.category",
              "to": "metadata.log_name"
            }
          },
          {
            "rename": {
              "from": "event.respipcategory",
              "to": "unmapped.event.respipcategory"
            }
          },
          {
            "rename": {
              "from": "event.deviceowner",
              "to": "device.owner"
            }
          },
          {
            "copy": {
              "from": "event.devicehostname",
              "to": "device.hostname"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "Date/Time"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[1]",
              "value": "Host"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 6
            }
          },
          {
            "constant": {
              "field": "activity_name",
              "value": "Traffic"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": 4
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 4003
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "DNS Activity"
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 400306
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "DNS Activity: Traffic"
            }
          },
          {
            "constant": {
              "field": "metadata.product.name",
              "value": "ZScaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.5.0"
            }
          },
          {
            "constant": {
              "field": "severity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "event.type",
              "value": "DNS"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "device.hostname"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "Hostname"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 1
            }
          },
          {
            "rename": {
              "from": "event.devicehostname",
              "to": "observables[0].value"
            }
          }
        ]
      },
      {
        "predicate": "sourcetype matches 'zscalernss-tunnel'",
        "transformations": [
          {
            "rename": {
              "from": "sourcetype",
              "to": "metadata.event_code"
            }
          },
          {
            "rename": {
              "from": "event.datetime",
              "to": "time_dt"
            }
          },
          {
            "rename": {
              "from": "event.Recordtype",
              "to": "metadata.labels[0]"
            }
          },
          {
            "rename": {
              "from": "event.tunneltype",
              "to": "tunnel_type"
            }
          },
          {
            "rename": {
              "from": "event.user",
              "to": "actor.user.uid"
            }
          },
          {
            "rename": {
              "from": "event.location",
              "to": "src_endpoint.location.region"
            }
          },
          {
            "copy": {
              "from": "event.sourceip",
              "to": "src_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "event.destinationip",
              "to": "dst_endpoint.ip"
            }
          },
          {
            "copy": {
              "from": "event.sourceport",
              "to": "src_endpoint.port"
            }
          },
          {
            "rename": {
              "from": "event.txbytes",
              "to": "traffic.bytes_out"
            }
          },
          {
            "rename": {
              "from": "event.rxbytes",
              "to": "traffic.bytes_in"
            }
          },
          {
            "rename": {
              "from": "event.dpdrec",
              "to": "traffic.packets_in"
            }
          },
          {
            "rename": {
              "from": "event.recordid",
              "to": "metadata.uid"
            }
          },
          {
            "rename": {
              "from": "event.event",
              "to": "status_detail"
            }
          },
          {
            "rename": {
              "from": "event.eventreason",
              "to": "status"
            }
          },
          {
            "rename": {
              "from": "event.sourceportstart",
              "to": "unmapped.event.sourceportstart"
            }
          },
          {
            "rename": {
              "from": "event.destinationportstart",
              "to": "unmapped.event.destinationportstart"
            }
          },
          {
            "rename": {
              "from": "event.srcipstart",
              "to": "unmapped.event.srcipstart"
            }
          },
          {
            "rename": {
              "from": "event.srcipend",
              "to": "unmapped.event.srcipend"
            }
          },
          {
            "rename": {
              "from": "event.destinationipstart",
              "to": "unmapped.event.destinationipstart"
            }
          },
          {
            "rename": {
              "from": "event.destinationipend",
              "to": "unmapped.event.destinationipend"
            }
          },
          {
            "rename": {
              "from": "event.lifetime",
              "to": "duration"
            }
          },
          {
            "rename": {
              "from": "event.ikeversion",
              "to": "unmapped.event.ikeversion"
            }
          },
          {
            "rename": {
              "from": "event.lifebytes",
              "to": "unmapped.event.lifebytes"
            }
          },
          {
            "rename": {
              "from": "event.spi",
              "to": "unmapped.event.spi"
            }
          },
          {
            "rename": {
              "from": "event.algo",
              "to": "unmapped.event.algo"
            }
          },
          {
            "rename": {
              "from": "event.authentication",
              "to": "unmapped.event.authentication"
            }
          },
          {
            "rename": {
              "from": "event.authtype",
              "to": "unmapped.event.authtype"
            }
          },
          {
            "rename": {
              "from": "event.protocol",
              "to": "unmapped.event.protocol"
            }
          },
          {
            "rename": {
              "from": "event.tunnelprotocol",
              "to": "unmapped.event.tunnelprotocol"
            }
          },
          {
            "rename": {
              "from": "event.policydirection",
              "to": "unmapped.event.policydirection"
            }
          },
          {
            "copy": {
              "from": "event.destinationport",
              "to": "dst_endpoint.port"
            }
          },
          {
            "rename": {
              "from": "event.spi_in",
              "to": "unmapped.event.spi_in"
            }
          },
          {
            "rename": {
              "from": "event.spi_out",
              "to": "unmapped.event.spi_out"
            }
          },
          {
            "constant": {
              "field": "tunnel_type_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "status_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "Date/Time"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[1]",
              "value": "Host"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 1
            }
          },
          {
            "constant": {
              "field": "activity_name",
              "value": "Open"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": 4
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 4014
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "Tunnel Activity"
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 401401
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "Tunnel Activity: Open"
            }
          },
          {
            "constant": {
              "field": "metadata.product.name",
              "value": "ZScaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.5.0"
            }
          },
          {
            "constant": {
              "field": "severity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "event.type",
              "value": "Tunnel"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "src_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          },
          {
            "rename": {
              "from": "event.sourceip",
              "to": "observables[0].value"
            }
          },
          {
            "constant": {
              "field": "observables[1].name",
              "value": "dst_endpoint.ip"
            }
          },
          {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          },
          {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          },
          {
            "rename": {
              "from": "event.destinationip",
              "to": "observables[1].value"
            }
          },
          {
            "constant": {
              "field": "observables[2].name",
              "value": "src_endpoint.port"
            }
          },
          {
            "constant": {
              "field": "observables[2].type",
              "value": "Port"
            }
          },
          {
            "constant": {
              "field": "observables[2].type_id",
              "value": 11
            }
          },
          {
            "rename": {
              "from": "event.sourceport",
              "to": "observables[2].value"
            }
          },
          {
            "constant": {
              "field": "observables[3].name",
              "value": "dst_endpoint.port"
            }
          },
          {
            "constant": {
              "field": "observables[3].type",
              "value": "Port"
            }
          },
          {
            "constant": {
              "field": "observables[3].type_id",
              "value": 11
            }
          },
          {
            "rename": {
              "from": "event.destinationport",
              "to": "observables[3].value"
            }
          }
        ]
      },
      // filescantimems attribute is only present in SaaS Security File event
      {
        "predicate": "filescantimems matches '.*'",
        "transformations": [
          {
            "rename": {
              "from": "datetime",
              "to": "time_dt"
            }
          },
          {
            "rename": {
              "from": "recordid",
              "to": "metadata.uid"
            }
          },
          {
            "rename": {
              "from": "company",
              "to": "actor.user.org.name"
            }
          },
          {
            "rename": {
              "from": "tenant",
              "to": "metadata.tenant_uid"
            }
          },
          {
            "rename": {
              "from": "login",
              "to": "actor.user.email_addr"
            }
          },
          {
            "rename": {
              "from": "dept",
              "to": "actor.user.org.ou_name"
            }
          },
          {
            "rename": {
              "from": "applicationname",
              "to": "actor.app_name"
            }
          },
          {
            "rename": {
              "from": "filename",
              "to": "file.name"
            }
          },
          {
            "rename": {
              "from": "filesource",
              "to": "file.path"
            }
          },
          {
            "rename": {
              "from": "filemd5",
              "to": "file.hashes.value"
            }
          },
          {
            "rename": {
              "from": "threatname",
              "to": "malware[0].name"
            }
          },
          {
            "rename": {
              "from": "policy",
              "to": "scan.name"
            }
          },
          {
            "rename": {
              "from": "dlpdictnames",
              "to": "unmapped.dlpdictnames"
            }
          },
          {
            "rename": {
              "from": "dlpdictcount",
              "to": "unmapped.dlpdictcount"
            }
          },
          {
            "rename": {
              "from": "dlpenginenames",
              "to": "unmapped.dlpenginenames"
            }
          },
          {
            "rename": {
              "from": "fullurl",
              "to": "file.url"
            }
          },
          {
            "rename": {
              "from": "lastmodtime",
              "to": "file.modified_time"
            }
          },
          {
            "rename": {
              "from": "filescantimems",
              "to": "duration"
            }
          },
          {
            "rename": {
              "from": "filedownloadtimems",
              "to": "unmapped.filedownloadtimems"
            }
          },
          {
            "constant": {
              "field": "algorithm_id",
              "value": 1
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "Host"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[1]",
              "value": "Security Control"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[2]",
              "value": "Date/Time"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 5
            }
          },
          {
            "constant": {
              "field": "activity_name",
              "value": "Detect"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": 7
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Remediation"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 7002
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "File Remediation Activity"
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 700205
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "File Remediation Activity: Detect"
            }
          },
          {
            "constant": {
              "field": "metadata.product.name",
              "value": "ZScaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.5.0"
            }
          },
          {
            "constant": {
              "field": "severity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "event.type",
              "value": "Saas Security File"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "file.name"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "File Name"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 7
            }
          },
          {
            "rename": {
              "from": "filename",
              "to": "observables[0].value"
            }
          }
        ]
      },
      // combination of login, applicationname, object_name_1, object_name_2 attribute is onlhy present in SaaS Security Activity event
      {
        "predicate": "login matches '.*' && applicationname matches '.*' && object_name_1 matches '.*' && object_name_2 matches '.*'",
        "transformations": [
          {
            "copy": {
              "from": "login",
              "to": "actor.user.email_addr"
            }
          },
          {
            "rename": {
              "from": "tenant",
              "to": "web_resources[0].name"
            }
          },
          {
            "rename": {
              "from": "object_type",
              "to": "web_resources[0].data.object_type"
            }
          },
          {
            "rename": {
              "from": "applicationname",
              "to": "actor.app_name"
            }
          },
          {
            "rename": {
              "from": "object_name_1",
              "to": "web_resources[0].data.object_name_1"
            }
          },
          {
            "rename": {
              "from": "object_name_2",
              "to": "web_resources[0].data.object_name_2"
            }
          },
          {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "Host"
            }
          },
          {
            "constant": {
              "field": "activity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "activity_name",
              "value": "Other"
            }
          },
          {
            "constant": {
              "field": "category_uid",
              "value": 6
            }
          },
          {
            "constant": {
              "field": "category_name",
              "value": "Application Activity"
            }
          },
          {
            "constant": {
              "field": "class_uid",
              "value": 6001
            }
          },
          {
            "constant": {
              "field": "class_name",
              "value": "Web Resources Activity"
            }
          },
          {
            "constant": {
              "field": "type_uid",
              "value": 600199
            }
          },
          {
            "constant": {
              "field": "type_name",
              "value": "Web Resources Activity: Other"
            }
          },
          {
            "constant": {
              "field": "metadata.product.name",
              "value": "ZScaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "metadata.version",
              "value": "1.5.0"
            }
          },
          {
            "constant": {
              "field": "severity_id",
              "value": 99
            }
          },
          {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          },
          {
            "constant": {
              "field": "dataSource.name",
              "value": "Zscaler Internet Access"
            }
          },
          {
            "constant": {
              "field": "dataSource.vendor",
              "value": "ZScaler"
            }
          },
          {
            "constant": {
              "field": "event.type",
              "value": "Saas Security Activity"
            }
          },
          {
            "constant": {
              "field": "observables[0].name",
              "value": "actor.user.email_addr"
            }
          },
          {
            "constant": {
              "field": "observables[0].type",
              "value": "Email Address"
            }
          },
          {
            "constant": {
              "field": "observables[0].type_id",
              "value": 5
            }
          },
          {
            "rename": {
              "from": "login",
              "to": "observables[0].value"
            }
          }
        ]
      }
    ]
  }
}
