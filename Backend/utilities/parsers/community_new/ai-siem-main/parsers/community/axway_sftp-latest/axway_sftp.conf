{
  "attributes": {
    "dataSource.category": "system",
    "dataSource.name": "Axway SFTP",
    "dataSource.vendor": "Axway"
  },
  "patterns": {
    "timestampPattern": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z",
    "logPattern": "AxwaySFTP\\s+session_id=\"([^\"]+)\"\\s+user=\"([^\"]+)\"\\s+event=\"([^\"]+)\"(?:\\s+filePath=\"([^\"]+)\")?(?:\\s+fileSize=(\\d+))?(?:\\s+bytesTransferred=(\\d+))?(?:\\s+remote_ip=\"([^\"]+)\")?\\s+result=\"([^\"]+)\"\\s+message=\"([^\"]+)\""
  },
  "formats": [
    {
      "id": "axway_sftp_format",
      "format": "$timestamp=timestampPattern$ $logPattern$",
      "attributes": {
        "class_uid": 1006,
        "class_name": "File System Activity",
        "category_uid": 1,
        "activity_id": 99
      }
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "event = *",
        "transformations": [
          {
            "constant": {
              "value": "1006",
              "field": "class_uid"
            }
          },
          {
            "constant": {
              "value": "File System Activity",
              "field": "class_name"
            }
          },
          {
            "regex": {
              "field": "session_id",
              "pattern": "logPattern",
              "group": 1
            }
          },
          {
            "regex": {
              "field": "actor.user.name",
              "pattern": "logPattern", 
              "group": 2
            }
          },
          {
            "regex": {
              "field": "event_type",
              "pattern": "logPattern",
              "group": 3
            }
          },
          {
            "regex": {
              "field": "file.path",
              "pattern": "logPattern",
              "group": 4
            }
          },
          {
            "regex": {
              "field": "file.size",
              "pattern": "logPattern", 
              "group": 5
            }
          },
          {
            "regex": {
              "field": "traffic.bytes",
              "pattern": "logPattern",
              "group": 6
            }
          },
          {
            "regex": {
              "field": "src_endpoint.ip",
              "pattern": "logPattern",
              "group": 7
            }
          },
          {
            "regex": {
              "field": "status",
              "pattern": "logPattern",
              "group": 8
            }
          },
          {
            "regex": {
              "field": "message",
              "pattern": "logPattern",
              "group": 9
            }
          },
          {
            "constant": {
              "value": "1",
              "field": "activity_id",
              "predicate": "event_type = 'LOGIN'"
            }
          },
          {
            "constant": {
              "value": "2",
              "field": "activity_id", 
              "predicate": "event_type = 'UPLOAD'"
            }
          },
          {
            "constant": {
              "value": "3",
              "field": "activity_id",
              "predicate": "event_type = 'DOWNLOAD'"
            }
          },
          {
            "constant": {
              "value": "4",
              "field": "activity_id",
              "predicate": "event_type = 'DELETE'"
            }
          },
          {
            "constant": {
              "value": "5",
              "field": "activity_id",
              "predicate": "event_type = 'RENAME'"
            }
          },
          {
            "constant": {
              "value": "99",
              "field": "activity_id",
              "predicate": "activity_id = null"
            }
          },
          {
            "constant": {
              "value": "Create",
              "field": "activity_name",
              "predicate": "activity_id = '2'"
            }
          },
          {
            "constant": {
              "value": "Read", 
              "field": "activity_name",
              "predicate": "activity_id = '3'"
            }
          },
          {
            "constant": {
              "value": "Delete",
              "field": "activity_name", 
              "predicate": "activity_id = '4'"
            }
          },
          {
            "constant": {
              "value": "Rename",
              "field": "activity_name",
              "predicate": "activity_id = '5'"
            }
          },
          {
            "constant": {
              "value": "Login",
              "field": "activity_name",
              "predicate": "activity_id = '1'"
            }
          },
          {
            "constant": {
              "value": "Other",
              "field": "activity_name",
              "predicate": "activity_id = '99'"
            }
          },
          {
            "constant": {
              "value": "1",
              "field": "severity_id",
              "predicate": "status = 'SUCCESS'"
            }
          },
          {
            "constant": {
              "value": "3",
              "field": "severity_id",
              "predicate": "status = 'FAILURE'"
            }
          },
          {
            "constant": {
              "value": "Informational",
              "field": "severity",
              "predicate": "severity_id = '1'"
            }
          },
          {
            "constant": {
              "value": "High",
              "field": "severity",
              "predicate": "severity_id = '3'"
            }
          }
        ]
      }
    ]
  }
}