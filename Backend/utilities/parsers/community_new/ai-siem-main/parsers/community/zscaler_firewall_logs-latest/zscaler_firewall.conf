{

  "attributes": {
    "category_uid": "4",
    "category_name": "Network Activity"
    "metadata.product.name": "ZScaler Firewall",
    "metadata.product.vendor_name": "ZScaler",
    "metadata.version": "1.5.0",
    "dataSource.category": "security",
    "dataSource.name": "Zscaler Firewall",
    "dataSource.vendor": "ZScaler"
  },
  "formats": [
    {
      "format": "$unmapped.{parse=json}$",
      "rewrites": [
        {
          "input": "unmapped.datetime",
          "output": "timestamp",
          "match": ".*",
          "replace": "$0"
        }
      ]

    }  
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "true",
        "transformations": [
          {"constant": { "value": 4, "field": "category_uid"}}
          {"constant": { "value": "Network Activity", "field": "category_name"}}
          {"constant": { "value": 4001, "field": "class_uid"}}
          {"constant": { "value": "Network Activity", "field": "class_name"}}
          {"constant": { "value": 6, "field": "activity_id"}}
          {"constant": { "value": "Traffic", "field": "activity_name"}}

          {"constant": { "value": 0, "field": "severity_id"}}
          {"constant": { "value": 400106, "field": "type_uid"}}
          {"constant": { "value": "Network Activity: Traffic", "field": "type_name"}}

          {"rename": {"from": "unmapped.csip","to": "src_endpoint.ip"}},
          {"rename": {"from": "unmapped.csport","to": "src_endpoint.port"}},
          {"rename": {"from": "unmapped.cdip","to": "dst_endpoint.ip"}},
          {"rename": {"from": "unmapped.cdport","to": "dst_endpoint.port"}},
          
          {"rename": {"from": "unmapped.user","to": "actor.user.email_addr"}},
          {"rename": {"from": "unmapped.devicehostname","to": "device.hostname"}},
          {"rename": {"from": "unmapped.deviceowner","to": "device.owner.name"}},
          
          {"rename": {"from": "unmapped.datetime","to": "time"}},
          {"replace": {"field": "time", "regexp": "^[A-Za-z]{3}\\s(.*)", "replacement": "$1"}}
          {"cast": {"type": "datetime", "field": "time", "format": "MMM dd HH:mm:ss yyyy"}}

        ]      
      }
    ]
  }
}