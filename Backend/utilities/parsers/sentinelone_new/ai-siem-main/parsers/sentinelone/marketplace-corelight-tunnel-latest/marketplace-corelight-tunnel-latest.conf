{
  attributes: {
    "dataSource.category": "security",
    "dataSource.name": "Corelight",
    "dataSource.vendor": "Corelight",
    "class_uid": 4001,
    "category_uid": 4,
    "severity_id": 1,
    "severity": "Informational",
    "class_name": "Network Activity",
    "category_name": "Network Activity",
    "metadata.product.name": "Zeek",
    "metadata.product.vendor_name": "Zeek",
    "metadata.version": "1.1.0",
    "metadata.log_name": "tunnel",
    "app_name": "Zeek",
    "activity_id": 0
  },
  formats: [
    {
      format: "${parse=dottedJson}$",
      repeat: true,
      skipNumericConversion: true,
      rewrites: [
        {
          input: "tunnel_type",
          output: "unmapped.tunnel_type",
          match: ".*:(.*)",
          replace: "$1"
        }
      ]
    }
  ],
  mappings: {
    version: 0,
    mappings: [
      {
        predicate: "true",
        copies: [
          {inputs: ["ts"], output: "time", type: "string"}
          {inputs: ["uid"], output: "uuid", type: "string"}
          {inputs: ["action"], output: "activity_mapper", type: "string"}
        ],
        renames: [
          {inputs: ["ts"], output: "timestamp", type: "string"}
          {inputs: ["uid"], output: "metadata.uid", type: "string"}
          {inputs: ["id.orig_h"], output: "src_endpoint.ip", type: "string"}
          {inputs: ["id.resp_h"], output: "dst_endpoint.ip", type: "string"}
          {inputs: ["id.resp_p"], output: "dst_endpoint.port", type: "string"}
          {inputs: ["id.resp_h"], output: "src_endpoint.port", type: "string"}
        ],
        constants: [
          { value: 1, field: "activity_id", predicate: "activity_mapper contains 'DISCOVER'"}
          { value: "Open", field: "activity_name", predicate: "activity_mapper contains 'DISCOVER'"}
          { value: 2, field: "activity_id", predicate: "activity_mapper contains 'CLOSE'"}
          { value: "Close", field: "activity_name", predicate: "activity_mapper contains 'CLOSE'"}
          { value: 400101, field: "type_uid", predicate: "activity_mapper contains 'DISCOVER'"}
          { value: 400102, field: "type_uid", predicate: "activity_mapper contains 'CLOSE'"}
        ],
        drops: ["activity_mapper"]
      }
    ]
  }
}
