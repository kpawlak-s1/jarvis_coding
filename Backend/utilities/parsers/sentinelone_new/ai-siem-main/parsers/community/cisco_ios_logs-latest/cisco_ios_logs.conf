{
  "attributes": {
    "dataSource.vendor": "Cisco",
    "dataSource.name": "Cisco IOS",
    "dataSource.category": "network",
    "dataSource.technology": "network_device",
    "source": "cisco_ios"
  },
  
  "patterns": {
    "timestamp": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3,6})?([+-]\\d{2}:\\d{2}|Z)?",
    "ip_address": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
    "hostname": "[a-zA-Z0-9._-]+",
    "facility": "(SYS|LINK|LINEPROTO|BGP|OSPF|SEC_LOGIN|CRYPTO|TRACKING|DUAL|SFF8472|ENVIRONMENT|C4K_HWACLMAN)",
    "severity": "(emerg|alert|crit|err|warning|notice|info|debug)",
    "mnemonic": "[A-Z_]+",
    "interface": "(GigabitEthernet|TenGigabitEthernet|FastEthernet|Serial|Loopback|Tunnel|Vlan)\\d+/\\d+|\\d+",
    "quoted_string": "\"[^\"]*\"",
    "field_value": "[^\\s,}]+",
    "syslog_pattern": "\\*[A-Za-z]+ \\d{1,2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3}: %[^:]+: .*"
  },
  
  "formats": [
    {
      "id": "cisco_ios_syslog",
      "format": "\\{\"timestamp\":\"$timestamp$\",\"hostname\":\"$hostname$\",\"device_ip\":\"$ip_address{name=device_ip}$\",\"facility\":\"$field_value{name=facility}$\",\"severity\":\"$severity$\",\"mnemonic\":\"$mnemonic$\",\"facility_mnemonic\":\"$facility{name=facility_mnemonic}$\",\"sequence_number\":$field_value{name=sequence_number}$,\"message\":\"$field_value{name=message}$\",\"raw_message\":\"$syslog_pattern{name=raw_message}$\".*",
      "attributes": {
        "class_uid": 4001,
        "class_name": "Network Activity",
        "category_uid": 4,
        "category_name": "Network Activity",
        "type_uid": 400199,
        "activity_id": 99,
        "activity_name": "Other"
      },
      "rewrites": [
        {
          "input": "timestamp",
          "output": "time",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "hostname",
          "output": "device.hostname",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "device_ip",
          "output": "device.ip",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "message",
          "output": "message",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "raw_message",
          "output": "raw_data",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "facility_mnemonic",
          "output": "metadata.product.feature.name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "mnemonic",
          "output": "type_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "emerg",
          "replace": "5"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "alert|crit",
          "replace": "4"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "err|warning",
          "replace": "3"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "notice",
          "replace": "2"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "info|debug",
          "replace": "1"
        },
        {
          "input": "sequence_number",
          "output": "metadata.sequence",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "device_ip",
          "output": "observables",
          "match": ".*",
          "replace": "[{\"name\":\"device_ip\",\"type\":\"IP Address\",\"value\":\"$0\"}]"
        }
      ],
      "halt": true
    },
    {
      "id": "cisco_ios_interface_event",
      "format": "\\{\"timestamp\":\"$timestamp$\",\"hostname\":\"$hostname$\",.*\"interface_name\":\"$interface{name=interface_name}$\",\"interface_status\":\"$field_value{name=interface_status}$\".*",
      "attributes": {
        "class_uid": 4001,
        "class_name": "Network Activity",
        "category_uid": 4,
        "category_name": "Network Activity", 
        "type_uid": 400102,
        "activity_id": 2,
        "activity_name": "Interface Change"
      },
      "rewrites": [
        {
          "input": "timestamp",
          "output": "time",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "hostname",
          "output": "device.hostname",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "interface_name",
          "output": "device.interface_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "interface_status",
          "output": "status",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "interface_status",
          "output": "status_id",
          "match": "up",
          "replace": "1"
        },
        {
          "input": "interface_status",
          "output": "status_id",
          "match": "down",
          "replace": "2"
        }
      ],
      "halt": true
    }
  ]
}