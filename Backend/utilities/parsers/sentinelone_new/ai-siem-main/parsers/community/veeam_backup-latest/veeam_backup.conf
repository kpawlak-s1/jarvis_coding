{
  "attributes": {
    "dataSource.category": "system",
    "dataSource.name": "Veeam Backup",
    "dataSource.vendor": "Veeam",
    "metadata.product.name": "Veeam Backup",
    "metadata.product.vendor_name": "Veeam",
    "metadata.version": "1.0.0"
  },
  "formats": [
    {
      "format": "$unmapped.{parse=gron}$",
      "rewrites": [
        {
          "input": "unmapped.timestamp",
          "output": "timestamp",
          "match": ".*",
          "replace": "$0"
        }
      ]
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "true",
        "transformations": [
          {
            "constant": {
              "value": 1001,
              "field": "class_uid"
            }
          },
          {
            "constant": {
              "value": "System Activity",
              "field": "class_name"
            }
          },
          {
            "constant": {
              "value": 1,
              "field": "category_uid"
            }
          },
          {
            "constant": {
              "value": "System",
              "field": "category_name"
            }
          },
          {
            "constant": {
              "value": 100199,
              "field": "type_uid"
            }
          },
          {
            "copy": {
              "from": "unmapped.timestamp",
              "to": "time"
            }
          },
          {
            "cast": {
              "field": "time",
              "type": "iso8601TimestampToEpochSec"
            }
          },
          {
            "rename": {
              "from": "unmapped.JobID",
              "to": "job.uid"
            }
          },
          {
            "rename": {
              "from": "unmapped.JobName",
              "to": "job.name"
            }
          },
          {
            "rename": {
              "from": "unmapped.JobSessionID",
              "to": "session.uid"
            }
          },
          {
            "rename": {
              "from": "unmapped.JobResult",
              "to": "status_id"
            }
          },
          {
            "rename": {
              "from": "unmapped.Description",
              "to": "message"
            }
          },
          {
            "rename": {
              "from": "unmapped.WarningCount",
              "to": "warning_count"
            }
          },
          {
            "rename": {
              "from": "unmapped.AffectedObjects",
              "to": "resource.name"
            }
          },
          {
            "rename": {
              "from": "unmapped.Duration",
              "to": "duration"
            }
          },
          {
            "rename": {
              "from": "unmapped.ObjectsProcessed",
              "to": "resource.count"
            }
          },
          {
            "rename": {
              "from": "unmapped.TotalSize",
              "to": "resource.size"
            }
          },
          {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          },
          {
            "constant": {
              "value": 1,
              "field": "activity_id",
              "predicate": "severity = 'Success'"
            }
          },
          {
            "constant": {
              "value": 2,
              "field": "activity_id",
              "predicate": "severity = 'Warning'"
            }
          },
          {
            "constant": {
              "value": 99,
              "field": "activity_id",
              "predicate": "severity = 'Error'"
            }
          },
          {
            "constant": {
              "value": "Create",
              "field": "activity_name",
              "predicate": "activity_id = '1'"
            }
          },
          {
            "constant": {
              "value": "Update",
              "field": "activity_name",
              "predicate": "activity_id = '2'"
            }
          },
          {
            "constant": {
              "value": "Other",
              "field": "activity_name",
              "predicate": "activity_id = '99'"
            }
          },
          {
            "constant": {
              "value": 1,
              "field": "severity_id",
              "predicate": "severity = 'Success'"
            }
          },
          {
            "constant": {
              "value": 2,
              "field": "severity_id",
              "predicate": "severity = 'Warning'"
            }
          },
          {
            "constant": {
              "value": 4,
              "field": "severity_id",
              "predicate": "severity = 'Error'"
            }
          }
        ]
      }
    ]
  }
}