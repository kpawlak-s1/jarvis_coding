{
  "attributes": {
    "dataSource.category": "system",
    "dataSource.name": "Cohesity Backup",
    "dataSource.vendor": "Cohesity"
  },
  "patterns": {
    "timestampPattern": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z",
    "logPattern": "Cohesity\\s+runId=\"([^\"]+)\"\\s+jobName=\"([^\"]+)\"\\s+objectName=\"([^\"]+)\"\\s+status=\"([^\"]+)\"(?:\\s+duration=\"([^\"]+)\")?(?:\\s+bytesProtected=([^\\s]+))?(?:\\s+throughput=\"([^\"]+)\")?(?:\\s+error=\"([^\"]+)\")?(?:\\s+initiatedBy=\"([^\"]+)\")?\\s+message=\"([^\"]+)\""
  },
  "formats": [
    {
      "id": "cohesity_format",
      "format": "$timestamp=timestampPattern$ $logPattern$",
      "attributes": {
        "class_uid": 1001,
        "class_name": "System Activity",
        "category_uid": 1,
        "activity_id": 99
      }
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "status = *",
        "transformations": [
          {
            "constant": {
              "value": "1001",
              "field": "class_uid"
            }
          },
          {
            "constant": {
              "value": "System Activity", 
              "field": "class_name"
            }
          },
          {
            "regex": {
              "field": "metadata.correlation_uid",
              "pattern": "logPattern",
              "group": 1
            }
          },
          {
            "regex": {
              "field": "job.name",
              "pattern": "logPattern",
              "group": 2
            }
          },
          {
            "regex": {
              "field": "resource.name",
              "pattern": "logPattern", 
              "group": 3
            }
          },
          {
            "regex": {
              "field": "status",
              "pattern": "logPattern",
              "group": 4
            }
          },
          {
            "regex": {
              "field": "duration",
              "pattern": "logPattern",
              "group": 5
            }
          },
          {
            "regex": {
              "field": "traffic.bytes",
              "pattern": "logPattern",
              "group": 6
            }
          },
          {
            "regex": {
              "field": "throughput",
              "pattern": "logPattern",
              "group": 7
            }
          },
          {
            "regex": {
              "field": "status_detail",
              "pattern": "logPattern",
              "group": 8
            }
          },
          {
            "regex": {
              "field": "actor.user.name",
              "pattern": "logPattern",
              "group": 9
            }
          },
          {
            "regex": {
              "field": "message",
              "pattern": "logPattern", 
              "group": 10
            }
          },
          {
            "constant": {
              "value": "1",
              "field": "activity_id",
              "predicate": "status = 'STARTED'"
            }
          },
          {
            "constant": {
              "value": "2",
              "field": "activity_id",
              "predicate": "status = 'SUCCESS'"
            }
          },
          {
            "constant": {
              "value": "3",
              "field": "activity_id", 
              "predicate": "status = 'FAILED'"
            }
          },
          {
            "constant": {
              "value": "4",
              "field": "activity_id",
              "predicate": "status = 'WARNING'"
            }
          },
          {
            "constant": {
              "value": "99",
              "field": "activity_id",
              "predicate": "activity_id = null"
            }
          },
          {
            "constant": {
              "value": "Start",
              "field": "activity_name",
              "predicate": "activity_id = '1'"
            }
          },
          {
            "constant": {
              "value": "Stop",
              "field": "activity_name",
              "predicate": "activity_id = '2'"
            }
          },
          {
            "constant": {
              "value": "Stop",
              "field": "activity_name", 
              "predicate": "activity_id = '3'"
            }
          },
          {
            "constant": {
              "value": "Stop",
              "field": "activity_name",
              "predicate": "activity_id = '4'" 
            }
          },
          {
            "constant": {
              "value": "Other",
              "field": "activity_name",
              "predicate": "activity_id = '99'"
            }
          },
          {
            "constant": {
              "value": "1",
              "field": "severity_id",
              "predicate": "status = 'SUCCESS'"
            }
          },
          {
            "constant": {
              "value": "2",
              "field": "severity_id",
              "predicate": "status = 'WARNING'"
            }
          },
          {
            "constant": {
              "value": "3",
              "field": "severity_id",
              "predicate": "status = 'FAILED'"
            }
          },
          {
            "constant": {
              "value": "1",
              "field": "severity_id",
              "predicate": "status = 'STARTED'"
            }
          },
          {
            "constant": {
              "value": "Informational",
              "field": "severity",
              "predicate": "severity_id = '1'"
            }
          },
          {
            "constant": {
              "value": "Medium",
              "field": "severity",
              "predicate": "severity_id = '2'"
            }
          },
          {
            "constant": {
              "value": "High",
              "field": "severity",
              "predicate": "severity_id = '3'"
            }
          }
        ]
      }
    ]
  }
}