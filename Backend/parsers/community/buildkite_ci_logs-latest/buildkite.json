{
    "attributes": {
        "dataSource.name": "Buildkite Audit",
        "dataSource.vendor": "Buildkite",
        "dataSource.category": "security",
        "metadata.product.name": "Buildkite Audit",
        "metadata.product.vendor_name": "Buildkite",
        "metadata.version": "1.5.0"
    },
    "formats": [
        {
            "format": "$unmapped.{parse=gron}$",
            "rewrites": [
                {
                    "input": "unmapped.occurredAt",
                    "output": "timestamp",
                    "match": ".*",
                    "replace": "$0"
                }
            ]
        }
    ],
    "mappings": {
        "version": 1,
        "mappings": [
            {
                "predicate": "true",
                "transformations": [
                    {
                        "copy": {
                            "from": "unmapped.type",
                            "to": "event.action"
                        }
                    },
                    {
                        "constant": {
                            "value": 3004,
                            "field": "class_uid"
                        }
                    },
                    {
                        "constant": {
                            "value": 3,
                            "field": "category_uid"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management",
                            "field": "class_name"
                        }
                    },
                    {
                        "constant": {
                            "value": "Identity & Access Management",
                            "field": "category_name"
                        }
                    },
                    {
                        "constant": {
                            "value": 1,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains ('created','added')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Create",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains ('created','added')"
                        }
                    },
                    {
                        "constant": {
                            "value": 300401,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains ('created','added')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Create",
                            "field": "type_name",
                            "predicate": "unmapped.type contains ('created','added')"
                        }
                    },
                    {
                        "constant": {
                            "value": 2,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains 'read'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Read",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains 'read'"
                        }
                    },
                    {
                        "constant": {
                            "value": 300402,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains 'read'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Read",
                            "field": "type_name",
                            "predicate": "unmapped.type contains 'read'"
                        }
                    },
                    {
                        "constant": {
                            "value": 3,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains ('updated','changed')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Update",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains ('updated','changed')"
                        }
                    },
                    {
                        "constant": {
                            "value": 300403,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains ('updated','changed')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Update",
                            "field": "type_name",
                            "predicate": "unmapped.type contains ('updated','changed')"
                        }
                    },
                    {
                        "constant": {
                            "value": 4,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains ('deleted','destroyed','removed')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Delete",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains ('deleted','destroyed','removed')"
                        }
                    },
                    {
                        "constant": {
                            "value": 300404,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains ('deleted','destroyed','removed')"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Delete",
                            "field": "type_name",
                            "predicate": "unmapped.type contains ('deleted','destroyed','removed')"
                        }
                    },
                    {
                        "constant": {
                            "value": 8,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains 'enabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Enable",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains 'enabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": 300408,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains 'enabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Enable",
                            "field": "type_name",
                            "predicate": "unmapped.type contains 'enabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": 9,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains 'disabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Disable",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains 'disabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": 300409,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains 'disabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Disable",
                            "field": "type_name",
                            "predicate": "unmapped.type contains 'disabled'"
                        }
                    },
                    {
                        "constant": {
                            "value": 10,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains 'activated'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Activate",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains 'activated'"
                        }
                    },
                    {
                        "constant": {
                            "value": 300410,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains 'activated'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Activate",
                            "field": "type_name",
                            "predicate": "unmapped.type contains 'activated'"
                        }
                    },
                    {
                        "constant": {
                            "value": 12,
                            "field": "activity_id",
                            "predicate": "unmapped.type contains 'revoked'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Suspend",
                            "field": "activity_name",
                            "predicate": "unmapped.type contains 'revoked'"
                        }
                    },
                    {
                        "constant": {
                            "value": 300412,
                            "field": "type_uid",
                            "predicate": "unmapped.type contains 'revoked'"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Suspend",
                            "field": "type_name",
                            "predicate": "unmapped.type contains 'revoked'"
                        }
                    },
                    {
                        "constant": {
                            "value": 99,
                            "field": "activity_id",
                            "predicate": "not (activity_id = *)"
                        }
                    },
                    {
                        "constant": {
                            "value": "Other",
                            "field": "activity_name",
                            "predicate": "not (activity_name = *)"
                        }
                    },
                    {
                        "constant": {
                            "value": 300499,
                            "field": "type_uid",
                            "predicate": "not (type_uid = *)"
                        }
                    },
                    {
                        "constant": {
                            "value": "Entity Management: Other",
                            "field": "type_name",
                            "predicate": "not (type_name = *)"
                        }
                    },
                    {
                        "constant": {
                            "value": 99,
                            "field": "severity_id"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.actor.node.email",
                            "to": "actor.user.email_addr"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.actor.name",
                            "to": "actor.user.full_name"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.actor.uuid",
                            "to": "actor.user.uid"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.actor.type",
                            "to": "actor.user.type"
                        }
                    },
                    {
                        "copy": {
                            "from": "actor.user.email_addr",
                            "to": "actor.user.name"
                        }
                    },
                    {
                        "replace": {
                            "field": "actor.user.name",
                            "regexp": "(.*?)@(.*)",
                            "replacement": "$1"
                        }
                    },
                    {
                        "copy": {
                            "from": "actor.user.email_addr",
                            "to": "actor.user.domain"
                        }
                    },
                    {
                        "replace": {
                            "field": "actor.user.domain",
                            "regexp": "(.*?)@(.*)",
                            "replacement": "$2"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.context.requestIpAddress",
                            "to": "src_endpoint.ip"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.context.requestIpAddress",
                            "to": "src_endpoint.ip"
                        }
                    },
                    {
                        "rename": {
                            "from": "unmapped.occurredAt",
                            "to": "time"
                        }
                    },
                    {
                        "cast": {
                            "field": "time",
                            "type": "iso8601TimestampToEpochSec"
                        }
                    }
                ]
            }
        ]
    }
}