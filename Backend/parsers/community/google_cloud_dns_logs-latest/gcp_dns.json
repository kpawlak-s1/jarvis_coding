{
  "attributes": {
    "dataSource.name": "GCP DNS",
    "dataSource.vendor": "GCP",
    "dataSource.category": "security",
    "metadata.product.name": "GCP DNS",
    "metadata.product.vendor_name": "GCP",
    "metadata.version": "1.5.0"
  },
  "formats": [
    {
      "format": "$unmapped.{parse=gron}$",
      "rewrites": [
        {
          "input": "unmapped.timestamp",
          "output": "timestamp",
          "match": ".*",
          "replace": "$0"
        }
      ]
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "true",
        "transformations": [
          { "constant": { "value": 4, "field": "category_uid" }},
          { "constant": { "value": "Network Activity", "field": "category_name" }},
          { "constant": { "value": 4003, "field": "class_uid" }},
          { "constant": { "value": "DNS Activity", "field": "class_name" }},
          { "constant": { "value": 1, "field": "activity_id" }},
          { "constant": { "value": "Query", "field": "activity_name" }},
          { "constant": { "value": 400301, "field": "type_uid" }},
          { "constant": { "value": "DNS Activity: Query", "field": "type_name" }},
                
          { "rename": { "from": "unmapped.jsonPayload.queryName", "to": "query.hostname" }},
          { "rename": { "from": "unmapped.jsonPayload.queryType", "to": "query.type" }},
          { "rename": { "from": "unmapped.jsonPayload.rdata", "to": "answers.rdata" }},
          { "rename": { "from": "unmapped.type", "to": "answers.rdata" }},

          { "rename": { "from": "unmapped.severity", "to": "severity_id" }},
          //mappings may be adjusted
          { "cast": { "type": "enum", "field": "severity_id", "enum": {"DEFAULT":0,"DEBUG":99,"INFO":1,"NOTICE":2,"WARNING":3,"ERROR":4,"CRITICAL":5,"ALERT":5,"EMERGENCY":6}}}
                   
          { "rename": { "from": "unmapped.receiveTimestamp", "to": "query_time" }},
          { "cast": { "field": "query_time", "type": "iso8601TimestampToEpochSec" }}
          { "rename": { "from": "unmapped.timestamp", "to": "time" }},
          { "cast": { "field": "time", "type": "iso8601TimestampToEpochSec" }}          
        ]
      }
    ]
  }
}
