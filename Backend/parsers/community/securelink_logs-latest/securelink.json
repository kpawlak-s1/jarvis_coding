{
  "attributes": {
    "dataSource.vendor": "SecureLink",
    "dataSource.name": "SecureLink",
    "dataSource.category": "security",
    "dataSource.technology": "remote_access",
    "source": "securelink"
  },
  
  "patterns": {
    "timestamp": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?[+-]\\d{2}:\\d{2}",
    "ip_address": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
    "email_address": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
    "event_id": "SL-\\d+",
    "session_id": "session_\\d+",
    "hostname": "[a-zA-Z0-9\\-_.]+",
    "field_value": "[^\\s,]+",
    "quoted_string": "\"[^\"]*\""
  },
  
  "formats": [
    {
      "id": "securelink_remote_access",
      "format": "$timestamp$ SecureLink eventId=$event_id{name=event_id}$ sessionId=$session_id{name=session_id}$ eventType=$quoted_string{name=event_type}$ severity=$quoted_string{name=severity}$ category=$quoted_string{name=category}$ vendorName=$quoted_string{name=vendor_name}$ vendorType=$quoted_string{name=vendor_type}$ vendorEmail=$email_address{name=vendor_email}$ technicianName=$quoted_string{name=technician_name}$ technicianId=$quoted_string{name=technician_id}$ sourceIp=$ip_address{name=source_ip}$ targetSystem=$quoted_string{name=target_system}$ targetIp=$ip_address{name=target_ip}$ targetHostname=$hostname{name=target_hostname}$ accessMethod=$quoted_string{name=access_method}$ businessJustification=$quoted_string{name=business_justification}$ riskLevel=$quoted_string{name=risk_level}$ approvalStatus=$quoted_string{name=approval_status}$ approver=$email_address{name=approver}$",
      "attributes": {
        "dataSource.app": "SecureLink Remote Access",
        "class_uid": 4001,
        "class_name": "Network Activity",
        "category_uid": 4,
        "category_name": "Network Activity",
        "type_uid": 400109,
        "activity_id": 1,
        "activity_name": "Open",
        "severity_id": 3
      },
      "rewrites": [
        {
          "input": "timestamp",
          "output": "time",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "event_id",
          "output": "metadata.correlation_uid",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "session_id",
          "output": "session.uid",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "vendor_name",
          "output": "actor.user.name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "vendor_email",
          "output": "actor.user.email_addr",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "technician_name",
          "output": "actor.user.full_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "technician_id",
          "output": "actor.user.uid",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "source_ip",
          "output": "src_endpoint.ip",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "target_ip",
          "output": "dst_endpoint.ip",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "target_hostname",
          "output": "dst_endpoint.hostname",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "target_system",
          "output": "dst_endpoint.name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "access_method",
          "output": "connection_info.protocol_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "vendor_type",
          "output": "actor.user.type",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "business_justification",
          "output": "message",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "approver",
          "output": "actor.authorizations",
          "match": ".*",
          "replace": "[{\"decision\":\"${approval_status}\",\"approver\":\"$0\"}]"
        },
        {
          "input": "event_type",
          "output": "type_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "category",
          "output": "category_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "event_type",
          "output": "activity_id",
          "match": "(?i)(START|ESTABLISHED|GRANTED|RECORDING)",
          "replace": "1"
        },
        {
          "input": "event_type",
          "output": "activity_id",
          "match": "(?i)(END|TERMINATED|EXECUTED|TRANSFER)",
          "replace": "2"
        },
        {
          "input": "event_type",
          "output": "activity_id",
          "match": "(?i)(DENIED|UNAUTHORIZED|VIOLATION)",
          "replace": "4"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(CRITICAL)",
          "replace": "5"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(HIGH)",
          "replace": "4"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(WARNING)",
          "replace": "3"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(INFO)",
          "replace": "1"
        },
        {
          "input": "approval_status",
          "output": "status_id",
          "match": "(?i)(Approved|Emergency Override)",
          "replace": "1"
        },
        {
          "input": "approval_status",
          "output": "status_id",
          "match": "(?i)(Denied|Pending)",
          "replace": "2"
        },
        {
          "input": "event_type",
          "output": "status_id",
          "match": "(?i)(UNAUTHORIZED|VIOLATION|DENIED)",
          "replace": "2"
        },
        {
          "input": "vendor_email",
          "output": "observables",
          "match": ".*",
          "replace": "[{\"name\":\"vendor_email\",\"type\":\"Email Address\",\"value\":\"$0\"},{\"name\":\"source_ip\",\"type\":\"IP Address\",\"value\":\"${source_ip}\"},{\"name\":\"target_ip\",\"type\":\"IP Address\",\"value\":\"${target_ip}\"},{\"name\":\"target_hostname\",\"type\":\"Hostname\",\"value\":\"${target_hostname}\"}]"
        }
      ],
      "halt": true
    }
  ]
}