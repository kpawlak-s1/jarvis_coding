{
  "attributes": {
    "dataSource.vendor": "Juniper",
    "dataSource.name": "Juniper Networks",
    "dataSource.category": "network",
    "dataSource.technology": "network_infrastructure",
    "source": "juniper_networks"
  },
  
  "patterns": {
    "timestamp": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?[+-]\\d{2}:\\d{2}",
    "ip_address": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
    "hostname": "[a-zA-Z0-9\\-_]+",
    "interface": "[a-zA-Z]+-\\d+/\\d+/\\d+",
    "process_id": "\\d+",
    "field_value": "[^\\s,]+",
    "quoted_string": "\"[^\"]*\""
  },
  
  "formats": [
    {
      "id": "juniper_networks_infrastructure",
      "format": "$timestamp$ JuniperNetworks hostname=$quoted_string{name=hostname}$ deviceType=$quoted_string{name=device_type}$ deviceIp=$ip_address{name=device_ip}$ severity=$quoted_string{name=severity}$ processName=$quoted_string{name=process_name}$ processId=$process_id{name=process_id}$ message=$quoted_string{name=message}$ eventCategory=$quoted_string{name=event_category}$ softwareVersion=$quoted_string{name=software_version}$ model=$quoted_string{name=model}$",
      "attributes": {
        "dataSource.app": "Juniper Networks Infrastructure",
        "class_uid": 4001,
        "class_name": "Network Activity",
        "category_uid": 4,
        "category_name": "Network Activity",
        "type_uid": 400101,
        "activity_id": 1,
        "activity_name": "Network Traffic",
        "severity_id": 3
      },
      "rewrites": [
        {
          "input": "timestamp",
          "output": "time",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "hostname",
          "output": "device.hostname",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "device_ip",
          "output": "src_endpoint.ip",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "device_type",
          "output": "device.type",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "process_name",
          "output": "process.name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "process_id",
          "output": "process.pid",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "message",
          "output": "message",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "event_category",
          "output": "category_name",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "software_version",
          "output": "device.os.version",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "model",
          "output": "device.hw_info.model",
          "match": ".*",
          "replace": "$0"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(alert|critical)",
          "replace": "5"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(error|warning)",
          "replace": "3"
        },
        {
          "input": "severity",
          "output": "severity_id",
          "match": "(?i)(notice|info)",
          "replace": "1"
        },
        {
          "input": "message",
          "output": "status_id",
          "match": "(?i)(up|established|OK|normal|committed|permit)",
          "replace": "1"
        },
        {
          "input": "message",
          "output": "status_id",
          "match": "(?i)(down|failure|timeout|deny|detected|flap|high)",
          "replace": "2"
        },
        {
          "input": "event_category",
          "output": "activity_id",
          "match": "(?i)(security)",
          "replace": "2"
        },
        {
          "input": "event_category",
          "output": "activity_id",
          "match": "(?i)(interface|routing|system)",
          "replace": "1"
        },
        {
          "input": "hostname",
          "output": "observables",
          "match": ".*",
          "replace": "[{\"name\":\"hostname\",\"type\":\"Hostname\",\"value\":\"$0\"},{\"name\":\"device_ip\",\"type\":\"IP Address\",\"value\":\"${device_ip}\"},{\"name\":\"device_type\",\"type\":\"Device\",\"value\":\"${device_type}\"}]"
        }
      ],
      "halt": true
    }
  ]
}